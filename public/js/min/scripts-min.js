$(document).ready(function(){function e(){$("#editor #id").val(""),$("#editor #title").val(""),$("#editor #content").summernote("reset")}function t(){$("#editor-modal").modal("hide")}function o(e){firebase.database().ref("posts").push(e)}function a(e,t){firebase.database().ref("posts/"+t+"/comments").push(e)}function i(e,t){console.log(e),console.log(t),firebase.database().ref("posts/"+t).set(e)}function s(e){var t={posts:e};console.log(t);var o=$("#post-list-template").html(),i=Handlebars.compile(o),s=i(t);$("#post-list").html(s),console.log("updatign list"),$(".delete-post").click(function(){var e=$(this).closest(".item").data("id");console.log("postid",e),firebase.database().ref("posts/"+e).remove()}),$(".edit-post").click(function(e){var t=$(this).closest(".item").data("id"),o=$(this).closest(".item").find(".title").text(),a=$(this).closest(".item").find(".content").text();console.log("initialTitle",o),$("#editor #id").val(t),$("#editor #title").val(o),$("#editor #content").summernote("editor.insertText",a),$("#editor-modal").modal("show")}),$(".item.post").click(function(){var e=$(this).data("id"),t=firebase.database().ref("posts/"+e);t.once("value",function(e){var o=e.val();console.log("single post data ",o);var i=$("#post-single-template").html(),s=Handlebars.compile(i),l=s(e.val());$("#post-single-body").html(l),$("#post-modal").modal("show"),$("#submit-comment").click(function(){var e={content:$("#comment-input").val(),datetime:moment().format("h:m A D/M/YY"),username:$(".user-info").data("user-display-name"),uid:$(".user-info").data("uid")},o=t.key;""!==e.content?a(e,o):console.log("Please enter a comment.")})})})}var l=firebase.database(),n=new firebase.auth.GithubAuthProvider,r={short:"DD MMMM - YYYY",long:"dddd DD.MM.YYYY HH:mm"},d=firebase.database().ref("posts");d.on("value",function(e){s(e.val()),console.log("from check for new post",e.val())}),$("#content").summernote({placeholder:"Write your awesome post here..",height:120,toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]]]}),$(".login").click(function(e){e.preventDefault(),firebase.auth().signInWithPopup(n).then(function(e){$(".login").closest("li").addClass("hide");var t=e.credential.accessToken,o=e.user;console.log(o),$(".user-info .avatar").attr("src",o.photoURL),$(".user-info .name").html(o.displayName),$(".user-info .name").html(o.email),$(".user-info").attr("data-user-email",o.email).attr("data-uid",o.uid).attr("data-uid",o.uid).attr("data-user-display-name",o.displayName),$(".user-info").removeClass("hide"),$(".new-post").closest("li").removeClass("hide"),$("#editor").attr("data-user-email",o.email).attr("data-uid",o.uid).attr("data-uid",o.uid).attr("data-user-display-name",o.displayName)}).catch(function(e){var t=e.code,o=e.message,a=e.email,i=e.credential})}),$(".logout").click(function(e){e.preventDefault(),console.log("log out click"),$(".user-info .avatar").attr("src",""),$(".user-info .name").html(""),$(".user-info").addClass("hide"),$(".login").closest("li").removeClass("hide"),$(".new-post").closest("li").removeClass("hide")}),$("#submit-post").click(function(){var a={title:$("#title").val(),content:$("#content").summernote("code"),datetime:moment().format("h:m A D/M/YY"),username:$("#editor").data("user-display-name"),uid:$("#editor").data("uid")};if(a.title&&""!==a.content){var s=$("#id").val();s?i(a,s):o(a),e(),t()}else console.log("Please enter a title and some content.")}),$("#cancel-edit-post").click(function(){e(),t()})});